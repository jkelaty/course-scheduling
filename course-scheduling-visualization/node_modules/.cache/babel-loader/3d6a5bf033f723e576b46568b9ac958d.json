{"ast":null,"code":"import _classCallCheck from\"/Users/jkelaty/Desktop/course-scheduling/course-scheduling/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/jkelaty/Desktop/course-scheduling/course-scheduling/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/jkelaty/Desktop/course-scheduling/course-scheduling/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/jkelaty/Desktop/course-scheduling/course-scheduling/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import ScheduleViewer from'./ScheduleViewer/ScheduleViewer.jsx';import PacmanLoad from'react-spinners/PacmanLoader';var Scheduler=/*#__PURE__*/function(_React$Component){_inherits(Scheduler,_React$Component);var _super=_createSuper(Scheduler);function Scheduler(props){var _this2;_classCallCheck(this,Scheduler);_this2=_super.call(this,props);_this2.courses_file=props.courses;_this2.instructors_file=props.instructors;_this2.courses=null;_this2.instructors=null;_this2.state={schedule:null,error:false};return _this2;}_createClass(Scheduler,[{key:\"componentDidMount\",value:function componentDidMount(){this.read_in_files();}},{key:\"read_in_files\",value:function read_in_files(){var _this=this;if(_this.courses_file){var courses_reader=new FileReader();courses_reader.onload=function(e){_this.courses=courses_reader.result;_this.received_file();};courses_reader.readAsText(_this.courses_file);}if(_this.instructors_file){var instructors_reader=new FileReader();instructors_reader.onload=function(e){_this.instructors=instructors_reader.result;_this.received_file();};instructors_reader.readAsText(_this.instructors_file);}}},{key:\"received_file\",value:function received_file(){var _this=this;if(this.courses&&this.instructors){var requestOptions={method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({courses:this.courses,preferences:this.instructors})};fetch('https://course-scheduling-jkelaty.herokuapp.com/schedule',requestOptions).then(function(response){return response.text();}).then(function(job_id){_this.ping_scheduler(job_id.replace('rq:job:',''));}).catch(function(error){_this.setState({error:true});});}}},{key:\"ping_scheduler\",value:function ping_scheduler(job_id){var _this3=this;var _this=this;fetch('https://course-scheduling-jkelaty.herokuapp.com/schedule/'+job_id,{method:'Get'}).then(function(response){return response.text();}).then(function(res){if(res==='Not yet'){setTimeout(function(){_this.ping_scheduler(job_id);},3000);}else{_this.setState({schedule:JSON.parse(res)});}}).catch(function(error){_this3.setState({error:true});});}},{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(React.Fragment,null,this.state.error?/*#__PURE__*/React.createElement(\"div\",{className:\"cs-error\"},/*#__PURE__*/React.createElement(\"p\",null,\"Uh oh! Something went wrong :(\"),/*#__PURE__*/React.createElement(\"p\",null,\"Reload the app and try again\")):this.state.schedule?/*#__PURE__*/React.createElement(ScheduleViewer,{schedule:this.state.schedule}):/*#__PURE__*/React.createElement(\"div\",{className:\"cs-loading\"},/*#__PURE__*/React.createElement(PacmanLoad,{size:\"50px\",color:\"#FFEE00\"})));}}]);return Scheduler;}(React.Component);export{Scheduler as default};","map":{"version":3,"sources":["/Users/jkelaty/Desktop/course-scheduling/course-scheduling/src/CourseScheduling/Scheduler.jsx"],"names":["React","ScheduleViewer","PacmanLoad","Scheduler","props","courses_file","courses","instructors_file","instructors","state","schedule","error","read_in_files","_this","courses_reader","FileReader","onload","e","result","received_file","readAsText","instructors_reader","requestOptions","method","headers","body","JSON","stringify","preferences","fetch","then","response","text","job_id","ping_scheduler","replace","catch","setState","res","setTimeout","parse","Component"],"mappings":"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","sourcesContent":["import React from 'react';\n\nimport ScheduleViewer from './ScheduleViewer/ScheduleViewer.jsx';\nimport PacmanLoad from 'react-spinners/PacmanLoader';\n\n\nexport default class Scheduler extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.courses_file     = props.courses;\n        this.instructors_file = props.instructors;\n\n        this.courses     = null;\n        this.instructors = null;\n\n        this.state = {\n            schedule: null,\n            error: false\n        };\n    }\n\n    componentDidMount() {\n        this.read_in_files();\n    }\n\n    read_in_files() {\n        let _this = this;\n\n        if ( _this.courses_file ) {\n            let courses_reader = new FileReader();\n            courses_reader.onload = function(e) {\n                _this.courses = courses_reader.result;\n                _this.received_file();\n            }\n            courses_reader.readAsText( _this.courses_file );\n        }\n\n        if ( _this.instructors_file ) {\n            let instructors_reader = new FileReader();\n            instructors_reader.onload = function(e) {\n                _this.instructors = instructors_reader.result;\n                _this.received_file();\n            }\n            instructors_reader.readAsText( _this.instructors_file );\n        }\n    }\n\n    received_file() {\n        let _this = this;\n\n        if ( this.courses && this.instructors ) {\n\n            const requestOptions = {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json'\n                },\n                body: JSON.stringify({\n                    courses: this.courses,\n                    preferences: this.instructors\n                })\n            };\n            \n            fetch('https://course-scheduling-jkelaty.herokuapp.com/schedule', requestOptions)\n                .then(response => response.text())\n                .then((job_id) => {\n                    _this.ping_scheduler(job_id.replace('rq:job:', ''));\n                })\n                .catch(error => {\n                    _this.setState({\n                        error: true\n                    });\n                });\n        }\n    }\n\n    ping_scheduler(job_id) {\n        let _this = this;\n\n        fetch('https://course-scheduling-jkelaty.herokuapp.com/schedule/' + job_id, { method: 'Get' })\n            .then(response => response.text())\n            .then((res) => {\n                if ( res === 'Not yet' ) {\n                    setTimeout(function() {\n                        _this.ping_scheduler(job_id);\n                    }, 3000);\n                }\n                else {\n                    _this.setState({\n                        schedule: JSON.parse(res)\n                    });\n                }\n            })\n            .catch(error => {\n                this.setState({\n                    error: true\n                });\n            });\n    }\n\n    render() {\n        return (\n            <>\n                { this.state.error ?\n                \n                    <div className=\"cs-error\">\n                        <p>Uh oh! Something went wrong :(</p>\n                        <p>Reload the app and try again</p>\n                    </div>\n                \n                : this.state.schedule ?\n\n                    <ScheduleViewer schedule = {this.state.schedule} />\n\n                :\n\n                    <div className=\"cs-loading\">\n                        <PacmanLoad size='50px' color='#FFEE00' />\n                    </div>\n\n                }\n            </>\n        );\n    }\n}\n\n"]},"metadata":{},"sourceType":"module"}